{%extends 'base.html'%}

{% load crispy_forms_tags %}
{% block title %}Profile{% endblock title %}
{% block content%}
<div class="justify-content-center card card-body" style="margin-top: 100px">
  <form action="/user/{{id}}" method="GET" autocomplete="off">
      {% csrf_token %}
      {{ form.as_p }}
  </form>

  <form action="/user/{{id}}" method="post" novalidate >
    <div class="form-row" style ="grid-column: 5px ">
      {% csrf_token %}
      {{form_pari.as_p}}
      <button type="submit" class="btn btn-primary">Cr√©er Pari</button>
    </div>
  </form>
</div>

<div class="justify-content-center card">
  {% if len_paris != 0 %}
  <h1> Listes de paris</h1>

  <table class="table table-responsive table-bordered table-hover table-sm table-striped" style="border:white;">
    <thead class="thead-light">
      <th>Nom</th>
      <th>Jour</th>
      <th>Type</th>
      <th> Email </th>
      <th>Invitation</th>
      <th>Parier</th>
      <th>Resultat</th>
      <th>Gagnants</th>
    </thead>
    <tbody>
      {%for pari in paris%}
        {% for p in pari %}
          <tr>
            <td>{{p.name}}</td>
            <td>{{p.jour}}</td>
            <td>{{p.pari_type}}</td>
            <td>
              <form  method="post" id="{{p.id}}" action="/user/{{p.pari_type}}/{{id}}/{{p.id}}" >
                <input type="email" class="form-control" name="email" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">
              </form>
            </td>
            <td><button type="submit" class="btn btn-primary" form="{{p.id}}">Inviter</button></td>
            <td>
              {% if  not p.resultat%}
                {%if p.pari_type == 'AUTRE'%}
                  <form class="needs-validation" action="/user/parier/{{p.pari_type}}/{{id}}/{{p.id}}" method="post" novalidate>

                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="OUI" id="Check1" name="select" required>
                          <label class="form-check-label" for="Check1">OUI</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="NON" id="Check2" name="select" required>
                          <label class="form-check-label" for="Check2">NON</label>
                          <div class="invalid-feedback">Choose at least one.</div>
                      </div>

                      <button class="btn btn-primary" type="submit">Parier</button>

                  </form>

                {%elif p.pari_type == 'COMBAT'%}
                <form class="needs-validation" action="/user/parier/{{p.pari_type}}/{{id}}/{{p.id}}" method="post" novalidate>

                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="{{p.joueur1}}" id="CheckCo1" name="pariCombat" required>
                        <label class="form-check-label" for="CheckCo1">{{p.joueur1}}</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="{{p.joueur2}}" id="CheckCo2" name="pariCombat" required>
                        <label class="form-check-label" for="CheckCo2">{{p.joueur2}}</label>
                        <div class="invalid-feedback">Choose at least one.</div>
                    </div>

                    <button class="btn btn-primary" type="submit">Parier</button>

                </form>
                {%else%}
                <form action="/user/parier/{{p.pari_type}}/{{id}}/{{p.id}}" method="post">

                  <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend">
                      <span class="input-group-text" id="inputGroup-sizing-sm">{{p.equipe1}}-{{p.equipe2}}</span>
                    </div>
                    <input type="text" name ="score" class="form-control" aria-label="{{p.equipe1}}-{{p.equipe2}}" aria-describedby="inputGroup-sizing-sm">
                  </div>

                  <button class="btn btn-primary" type="submit">Parier</button>
                </form>
                {%endif%}
              {%endif%}
            </td>
            <!-- Resulat du pari -->
            <td>
              {% if  not p.resultat%}
                {%if p.pari_type == 'AUTRE'%}
                  <form class="needs-validation" action="/user/resultat/{{p.pari_type}}/{{id}}/{{p.id}}" method="post" novalidate>

                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="OUI" id="Check1" name="select" required>
                          <label class="form-check-label" for="Check1">OUI</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="NON" id="Check2" name="select" required>
                          <label class="form-check-label" for="Check2">NON</label>
                          <div class="invalid-feedback">Choose at least one.</div>
                      </div>

                      <button class="btn btn-primary" type="submit">Resultat</button>

                  </form>

                {%elif p.pari_type == 'COMBAT'%}
                  <form class="needs-validation" action="/user/resultat/{{p.pari_type}}/{{id}}/{{p.id}}" method="post" novalidate>

                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="{{p.joueur1}}" id="CheckC1" name="combat" required>
                          <label class="form-check-label" for="CheckC1">{{p.joueur1}}</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="{{p.joueur2}}" id="CheckC2" name="combat" required>
                          <label class="form-check-label" for="CheckC2">{{p.joueur2}}</label>
                          <div class="invalid-feedback">Choose at least one.</div>
                      </div>

                      <button class="btn btn-primary" type="submit">Resultat</button>

                  </form>
                {%else%}
                  <form action="/user/resultat/{{p.pari_type}}/{{id}}/{{p.id}}" method="post">

                    <div class="input-group input-group-sm mb-3">
                      <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm">{{p.equipe1}}-{{p.equipe2}}</span>
                      </div>
                      <input type="text" name ="score" class="form-control" aria-label="{{p.equipe1}}-{{p.equipe2}}" aria-describedby="inputGroup-sizing-sm">
                    </div>

                    <button class="btn btn-primary" type="submit">Resultat</button>
                  </form>
                {%endif%}
              {%else%}
                {{p.resultat}}
              {%endif%}
            </td>
            <td>
              {%if p.pari_type == 'AUTRE'%}
                <form class="needs-validation" action="/user/gagnants/{{p.pari_type}}/{{id}}/{{p.id}}" method="post" novalidate>
                    <button class="btn btn-primary" type="submit">Gagnants</button>

                </form>

              {%elif p.pari_type == 'COMBAT'%}
                <form class="needs-validation" action="/user/gagnants/{{p.pari_type}}/{{id}}/{{p.id}}" method="post" novalidate>
                    <button class="btn btn-primary" type="submit">Gagnants</button>

                </form>
              {%else%}
                <form action="/user/gagnants/{{p.pari_type}}/{{id}}/{{p.id}}" method="post">
                  <button class="btn btn-primary" type="submit">Gagnants</button>
                </form>
              {%endif%}
            </td>
          </tr>
        {% endfor %}
      {% endfor %}

    </tbody>
  </table>
  {%endif%}

  {% if len_invite_paris != 0 %}
  <h1> Listes d'invitations de paris</h1>
  <table class="table table-responsive table-bordered table-hover table-sm table-striped" style="border:white;">
    <thead class="thead-light">
      <th>Nom</th>
      <th>Type</th>
      <th> Acccepter </th>
      <th>Refuser</th>
    </thead>
    <tbody>
      {%for invite in invites%}
        {% for i in invite %}
          <tr>
            <td>{{i.name}}</td>
            <td>{{i.pari_type}}</td>
            <td><button type="button" class="btn btn-primary"
              onclick="location.href='/user/accepter/{{i.pari_type}}/{{i.id}}'">
              Accepter</button>
            </td>
            <td><button type="button" class="btn btn-danger"
                onclick="location.href='/user/refuser/{{i.pari_type}}/{{i.id}}'">
              Refuser</button></td>
          </tr>
        {% endfor %}
      {% endfor %}

    </tbody>
  </table>
  {%endif%}
</div>
{%endblock%}
